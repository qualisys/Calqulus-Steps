import test from 'ava';

import { PeakFinder } from './peak-finder';

const hipsX = [1089.373,1088.761,1087.945,1087.472,1086.581,1086.092,1085.427,1083.751,1083.218,1082.531,1081.715,1080.453,1079.844,1079.37,1078.464,1077.198,1075.582,1075.128,1074.848,1074.715,1073.096,1072.876,1072.098,1071.479,1070.963,1070.474,1070.071,1069.42,1069.07,1068.681,1068.448,1068.195,1067.789,1067.897,1067.497,1067.361,1067.282,1067.056,1066.829,1067.714,1067.666,1067.737,1067.931,1069.202,1069.287,1069.439,1070.938,1070.99,1071.203,1072.307,1072.631,1073.072,1074.649,1074.902,1075.328,1076.627,1076.817,1077.427,1077.706,1078.788,1079.144,1080.537,1081.665,1083.007,1084.115,1084.747,1085.26,1085.758,1086.356,1087.624,1087.969,1088.413,1088.946,1089.407,1089.785,1090.48,1090.499,1090.965,1091.098,1091.582,1091.472,1092.078,1092.419,1093.011,1093.423,1093.779,1094.145,1094.588,1094.998,1094.963,1095.552,1095.926,1096.362,1096.316,1096.539,1096.988,1097.379,1097.181,1097.737,1098.105,1098.311,1098.301,1098.416,1098.761,1099.011,1099.283,1099.441,1099.521,1099.743,1100.005,1100.299,1100.461,1100.828,1101,1100.935,1101.003,1100.355,1100.307,1099.876,1099.372,1098.456,1098.26,1096.534,1096.216,1094.98,1094.438,1093.523,1091.61,1090.926,1089.814,1088.287,1087.648,1086.039,1085.487,1084.946,1083.356,1083.037,1082.685,1082.027,1080.837,1080.86,1080.281,1079.009,1078.458,1077.795,1077.056,1075.789,1075.122,1074.462,1073.32,1072.529,1071.596,1070.699,1070.094,1069.702,1068.972,1068.438,1067.471,1066.767,1066.164,1065.651,1064.575,1064.316,1064.012,1064.315,1063.813,1063.694,1063.293,1063.202,1063.161,1063.133,1063.923,1063.765,1063.83,1064.004,1065.313,1065.245,1065.869,1065.996,1067.062,1067.195,1068.144,1068.369,1069.525,1069.891,1071.036,1071.486,1072.618,1073.046,1074.141,1074.615,1075.138,1075.773,1076.787,1077.261,1077.607,1078.008,1078.59,1078.952,1079.233,1079.613,1079.913,1080.201,1080.609,1080.979,1081.17,1081.669,1081.795,1082.187,1082.435,1082.741,1083.007,1083.388,1083.701,1083.831,1084.218,1084.494,1084.614,1084.941,1084.772,1085.125,1084.962,1085.27,1085.496,1085.582,1085.751,1085.209,1085.553,1085.425,1085.693,1085.892,1086.034,1085.924,1086.134,1086.342,1086.538,1086.778,1087.055,1087.204,1087.165,1087.086,1086.62,1086.662,1086.106,1085.881,1085.166,1084.966,1084.193,1083.926,1082.853,1082.362,1081.634,1080.707,1079.253,1078.51,1077.677,1076.1,1075.339,1074.454,1073.413,1071.877,1070.901,1069.979,1068.137,1067.438,1066.703,1065.055,1064.523,1063.846,1063.359,1062.374,1061.655,1060.809,1060.276,1059.734,1058.196,1057.891,1057.318,1056.948,1056.892,1056.428,1055.921,1055.639,1055.46,1055.05,1054.871,1054.711,1054.676,1054.581,1054.905,1054.807,1055.607,1055.648,1055.791,1056.913,1056.849,1057.15,1058.298,1058.692,1060.025,1060.261,1060.663,1062.302,1063.087,1063.558,1064.955,1065.484,1066.1,1067.817,1068.269,1069.243,1069.778,1070.954,1071.795,1073.528,1074.243,1074.943,1075.489,1075.823,1077.414,1077.934,1078.482,1079.042,1079.644,1080.116,1080.305,1080.671,1080.934,1081.384,1081.042,1081.502,1081.691,1082.098,1082.345,1082.678,1083.026,1083.339,1083.786,1083.871,1084.396,1084.663,1085.176,1085.253,1085.705,1086.03,1086.161,1086.366,1086.676,1086.945,1087.288,1086.977,1087.355,1087.626,1088.218,1087.783,1087.767,1087.863,1088.067,1088.592,1089.005,1089.345,1089.558,1089.665,1089.937,1090.285,1090.444,1090.135,1089.979,1089.969,1089.15,1089.222,1088.405,1088.29,1086.872,1086.34,1085.439,1085.347,1084.677,1083.905,1082.533,1081.994,1080.669,1080.216,1079.614,1079.181,1078.383,1076.846,1076.556,1076.535,1076.263,1075.393,1075.431,1074.344,1074.263,1073.995,1073.959,1073.088,1072.348,1071.645,1071.12,1070.136,1069.611,1069.127,1068.922,1068.505,1067.999,1067.494,1067.043,1066.398,1066.082,1065.843,1065.5,1065.349,1065.538,1065.082,1065.324,1064.975,1064.796,1065.506,1065.373,1065.341,1066.382,1066.273,1066.339,1066.699,1067.045,1068.695,1068.752,1069.771,1069.869,1070.291,1071.746,1072.087,1073.31,1073.756,1075.135,1075.578,1076.254,1077.72,1078.156,1079.403,1079.925,1081.045,1081.626,1082.362,1083.636,1084.235,1084.914,1085.454,1086.201,1086.7,1087.197,1087.614,1088.181,1088.652,1089.266,1089.63,1090.249,1090.66,1091.145,1091.629,1091.898,1092.386,1092.979,1093.589,1094.211,1094.68,1095.295,1095.33,1095.816,1096.224,1096.716,1096.446,1096.984,1096.983,1097.529,1097.891,1098.262,1098.204,1098.626,1098.935,1098.98,1099.409,1099.818,1100.212,1100.561,1100.845,1100.912,1101.177,1101.551,1101.499,1101.799,1101.794,1102.025,1101.65,1101.572,1100.671,1100.631,1100.265,1100.117,1099.697,1098.797,1098.375,1097.687,1096.672,1095.958,1095.196,1094.33,1092.961,1092.431,1091.645,1089.481,1088.782,1088.106,1086.708,1085.962,1085.378,1084.468,1083.682,1081.446,1080.752,1080.307,1079.442,1078.248,1077.657,1077.197,1076.453,1075.612,1075.2,1074.428,1073.505,1072.989,1072.266,1071.698,1071.231,1071.09,1070.64,1070.252,1069.912,1069.453,1069.267,1069.572,1069.242,1069.788,1070.562,1070.536,1070.566,1071.209,1071.91,1072.192,1072.285,1073.346,1073.574,1075.157,1075.336,1076.007,1076.397,1077.381,1077.794,1078.971,1079.279,1080.567,1082.279,1083.076,1084.041,1084.708,1085.485,1086.474,1086.897,1087.413,1088.055,1088.742,1089.226,1090.024,1090.546,1091.177,1091.724,1091.993,1092.57,1093.208,1093.674,1094.078,1094.116,1094.576,1094.984,1095.511,1096.09,1096.568,1097.029,1097.524,1098.025,1098.609,1099.33,1099.814,1100.422,1100.761,1100.624,1101.377,1101.979,1102.381,1102.785,1103.024,1103.355,1103.826,1104.276,1104.065,1104.529,1105.145,1105.562,1106.071,1106.367,1106.564,1106.814,1107.171,1107.505,1107.868,1108.244,1108.575,1108.636,1108.935,1109.035,1108.548,1108.701,1108.141,1107.564,1107.383,1106.309,1106.097,1105.574,1103.96,1103.365,1101.862,1101.192,1099.642,1098.93,1097.806,1097.03,1095.719,1095.117,1094.657,1092.942,1092.486,1091.86,1091.474,1090.997,1090.558,1089.357,1088.741,1088.459,1087.269,1086.905,1087.434,1086.548,1086.255,1085.748,1085.114,1084.444,1083.774,1083.361,1082.63,1081.4,1081.005,1080.399,1080.281,1079.891,1079.57,1079.291,1078.828,1079.764,1079.178,1078.828,1078.526,1078.965,1078.992,1079.13,1080.069,1079.858,1079.917,1080.208,1080.572,1082.08,1082.007,1082.348,1083.321,1083.713,1084.914,1085.233,1085.862,1087.259,1087.774,1089.144,1089.785,1091.002,1091.756,1092.941,1093.713,1095.087,1095.742,1096.878,1097.512,1098.222,1098.787,1099.826,1100.255,1100.819,1101.391,1101.851,1102.332,1102.805,1103.33,1103.752,1104.21,1104.701,1105.17,1105.586,1106.033,1106.583,1106.988,1107.522,1107.974,1108.527,1109.025,1109.569,1109.966,1110.434,1110.722,1111.112,1111.548,1111.249,1111.727,1112.117,1111.77,1112.262,1112.716,1113.032,1113.051,1112.711,1112.948,1113.424,1113.802,1114.091,1114.525,1114.92,1115.18,1115.424,1115.382,1115.553,1115.74,1115.469,1115.67,1114.676,1114.758,1114.614,1114.059,1113.91,1113.565,1112.676,1111.496,1110.972,1110.227,1109.033,1108.317,1107.482,1106.618,1104.835,1104.102,1103.26,1102.384,1100.531,1099.868,1098.654,1098.072,1097.124,1095.245,1094.579,1093.602,1092.66,1091.768,1091.12,1089.991,1089.623,1088.147,1087.709,1086.413,1086.038,1085.128,1084.389,1083.733,1082.797,1082.166,1081.854,1081.34,1080.888,1080.786,1080.016,1079.667,1079.441,1079.215,1078.739,1078.808,1079.63,1079.43,1080.189,1080.041,1080.105,1080.833,1080.792,1081.024,1081.389,1082.796,1082.97,1083.84,1084.08,1085.009,1085.318,1086.388,1086.738,1087.61,1088.125,1089.04,1089.608,1090.064,1090.542,1091.171,1091.632,1092.796,1093.253,1093.762,1094.282,1094.891,1095.474,1095.767,1096.218,1096.451,1096.815,1097.293,1097.543,1097.81,1098.213,1098.358,1098.601,1099.125,1099.321,1099.439,1099.755,1099.968,1099.86,1100.125,1100.193,1100.432,1100.074,1100.459,1100.542,1100.698,1100.52,1100.818,1101.064,1100.945,1101.23,1100.895,1101.25,1101.594,1101.86,1102.123,1102.152,1102.269,1102.377,1102.579,1102.758,1102.921,1103.037,1103.248,1103.313,1103.26,1103.19,1102.423,1102.422,1101.88,1101.502,1100.883,1099.144,1098.609,1097.788,1095.827,1095.165,1093.431,1092.519,1090.722,1089.712,1088.081,1087.184,1085.663,1084.709,1083.443,1082.662,1081.678,1080.118,1079.479,1078.899,1077.717,1077.128,1075.882,1075.408,1074.342,1073.38,1072.547,1072.437,1071.485,1070.814,1070.031,1069.412,1068.826,1068.111,1067.286,1066.316,1065.435,1064.829,1063.685,1062.735,1062.313,1062.206,1061.923,1061.359,1060.693,1060.593,1060.234,1060.058,1060.455,1060.249,1060.709,1060.606,1060.618,1060.681,1060.933,1062.109,1062.195,1062.211,1063.026,1067.211,1067.372,1068.627,1068.825,1069.872,1070.147,1071.058,1071.348,1072.216,1072.432,1072.825,1073.331,1074.538,1074.857,1073.972,1074.259,1074.673,1075.098,1075.428,1075.877,1076.283,1076.575,1076.992,1077.184,1077.393,1077.676,1077.853,1078.141,1078.178,1078.502,1078.647,1078.811,1078.781,1079.039,1079.161,1079.421,1079.568,1079.702,1079.972,1080.301,1080.395,1080.563,1080.718,1080.307,1080.483,1080.619,1080.036,1080.306,1080.375,1080.417,1079.721,1080.197,1080.388,1080.229,1080.173,1080.153,1080.321,1080.365,1080.464,1080.704,1080.929,1080.94,1080.793,1080.813,1080.5,1080.41,1079.675,1079.485,1079.07,1079.003,1078.584,1078.017,1077.305,1076.229,1075.394,1074.276,1072.578,1071.845,1071.021,1069.292,1068.369,1067.318,1065.318,1064.488,1063.762,1063,1061.382,1060.518,1059.154,1058.79,1058.234,1057.251,1056.467,1055.729,1055.308,1054.897,1053.585,1053.079,1052.41,1051.852,1051.118,1050.824,1050.549,1050.363,1050.098,1049.8,1049.382,1049.239,1048.893,1049.188,1049.097,1049.101,1049.2,1050.02,1050.031,1050.048,1050.822,1051.138,1051.404,1052.621,1052.871,1054.294,1054.681,1055.273,1055.441,1056.929,1057.61,1057.97,1059.764,1059.851,1060.329,1060.749,1062.505,1064.09,1065.152,1066.135,1066.86,1068.123,1068.793,1069.748,1070.562,1071.489,1072.233,1073.317,1073.182,1073.531,1073.946,1074.493,1074.678,1074.851,1074.468,1074.692,1075.697,1076.059,1076.145,1075.994,1076.441,1076.758,1077.23,1077.684,1078.127,1078.631,1078.818,1079.338,1079.105,1079.528,1079.954,1080.38,1080.097,1080.573,1081.006,1081.326,1081.382,1081.705,1081.872,1082.062,1082.09,1082.217,1082.31,1082.487,1082.732,1083.018,1083.052,1082.871,
	1083.117,1083.135,1082.475,1082.579,1081.726,1081.75,1080.505,1080.468,1079.607,1079.295,1078.615,1077.27,1076.648,1075.83,1074.125,1073.512,1072.283,1071.761,1070.637,1069.829,1069.096,1067.84,1067.234,1066.693,1065.971,1065.318,1064.842,1063.802,1062.594,1062.321,1062.207,1061.839,1061.363,1060.793,1060.162,1059.239,1058.525,1057.851,1057.15,1056.74,1055.983,1055.177,1054.448,1054.002,1053.947,1053.565,1053.196,1052.786,1052.376,1051.999,1055.17,1055.145,1056.359,1056.286,1056.342,1057.386,1057.395,1057.871,1058.414,1059.032,1060.611,1060.783,1061.208,1061.821,1061.212,1061.516,1062.383,1062.702,1063.949,1064.421,1065.976,1067.514,1068.142,1069.482,1070.091,1071.598,1072.359,1073.322,1074.347,1076.034,1076.887,1077.676,1078.67,1079.54,1080.707,1081.592,1082.08,1082.878,1083.494,1084.212,1084.878,1085.455,1086.329,1086.767,1087.432,1088.034,1088.52,1089.302,1090.04,1090.676,1091.54,1092.105,1092.978,1093.485,1094.306,1094.752,1095.053,1095.724,1096.022,1096.61,1096.237,1096.895,1097.387,1097.641,1097.929,1097.963,1098.59,1099.147,1099.786,1100.589,1101.028,1101.525,1102.045,1102.575,1102.705,1103.061,1102.711,1103.122,1103.209,1103.478,1103.698,1103.414,1103.461,1103.574,1103.325,1102.837,1102.685,1102.437,1101.898,1101.734,1100.912,1100.684,1100.337,1099.909,1098.407,1097.385,1096.853,1096.392,1095.599,1094.87,1093.558,1093.279,1093.094,1091.267,1090.951,1090.289,1090.105,1089.338,1088.961,1087.616,1087.462,1086.773,1086.383,1085.675,1085.384,1085.218,1084.947,1084.587,1084.552,1084.382,1084.327,1084.435,1084.158,1084.068,1084.177,1084.303,1084.5,1085.594,1085.76,1086.089,1086.498,1086.775,1088.139,1088.423,1089.018,1090.263,1091.313,1091.7,1093.089,1093.337,1093.983,1094.49,1096.83,1097.32,1098.712,1099.522,1101.324,1102.111,1103.688,1104.317,1105.131,1105.745,1106.511,1107.386,1108.288,1109.067,1109.743,1110.108,1110.584,1111.145,1111.881,1112.729,1113.116,1113.842,1114.995,1115.602,1116.104,1116.654,1117.219,1117.797,1118.467,1118.914,1119.723,1120.199,1121.226,1121.833,1122.485,1123.156,1123.415,1124.259,1124.925,1125.241,1125.92,1126.561,1126.817,1127.452,1128.037,1128.579,1128.936,1129.497,1130.041,1130.507,1130.832,1131.22,1131.629,1131.95,1132.47,1133.01,1133.476,1133.848,1134.198,1134.459,1134.874,1134.583,1134.68,1134.394,1134.15,1134.059,1132.679,1132.634,1131.29,1130.841,1129.273,1128.759,1127.162,1126.498,1125.039,1124.345,1122.757,1122.127,1121.454,1119.633,1119.244,1118.574,1117.367,1117.019,1116.6,1115.963,1115.317,1114.879,1113.684,1112.771,1112.381,1111.985,1111.132,1110.451,1109.908,1109.22,1108.547,1107.395,1107.041,1106.159,1105.603,1104.577,1103.413,1102.858,1102.142,1100.518,1100.065,1099.913,1098.968,1098.497,1097.964,1097.802,1097.108,1096.571,1096.168,1095.84,1095.591,1096.55,1096.021,1095.922,1095.968,1097.176,1096.989,1097.364,1097.713,1098.865,1098.873,1099.83,1100.222,1101.313,1101.469,1102.248,1103.985,1104.434,1105.76,1106.696,1107.521,1109.009,1109.586,1110.736,1111.465,1111.817,1112.354,1112.944,1113.853,1114.385,1114.977,1115.581,1116.314,1116.856,1117.436,1118.082,1118.578,1119.146,1119.813,1120.392,1120.994,1121.437,1121.904,1122.389,1122.821,1123.234,1123.499,1124.009,1124.335,1124.818,1124.877,1125.17,1125.685,1125.981,1125.793,1126.277,1126.643,1126.483,1126.691,1127.023,1127.321,1127.586,1127.951,1128.295,1128.56,1128.678,1129.061,1129.482,1129.802,1130.012,1130.376,1130.563,1130.716,1130.902,1131.16,1131.174,1131.258,1130.77,1130.619,1129.943,1129.68,1128.788,1128.393,1127.655,1126.514,1125.386,1123.747,1122.886,1121.789,1120.596,1118.757,1117.632,1116.32,1115.352,1114.211,1112.34,1111.486,1109.925,1109.287,1108.353,1107.33,1105.887,1104.871,1103.376,1102.689,1102.083,1101.212,1099.817,1098.943,1098.154,1097.44,1096.395,1095.71,1094.566,1093.847,1093.179,1092.428,1091.189,1090.568,1090.057,1089.568,1088.648,1088.322,1087.911,1087.449,1087.644,1087.105,1086.759,1086.565,1086.392,1087.453,1087.113,1087.137,1088.03,1087.92,1088.376,1088.526,1088.791,1089.656,1089.526,1090.842,1091.288,1092.615,1093.03,1093.654,1095.609,1096.325,1096.708,1096.917,1097.653,1100.12,1100.623,1101.261,1101.965,1102.589,1103.624,1104.193,1105.036,1105.411,1106.029,1106.465,1106.852,1107.214,1107.569,1107.951,1108.164,1108.536,1108.918,1109.162,1109.565,1109.936,1110.253,1110.657,1111.009,1111.792,1112.061,1112.189,1112.578,1112.661,1113.033,1113.071,1113.375,1113.396,1113.044,1113.313,1113.292,1113.513,1113.801,1113.97,1113.973,1113.854,1114.169,1114.458,1114.786,1114.467,1114.336,1114.322,1114.254,1114.14,1114.038,1114.143,1114.266,1114.453,1114.456,1114.513,1113.886,1113.864,1112.971,1112.584,1111.445,1111.016,1109.187,1108.604,1106.864,1105.79,1104.237,1103.242,1101.976,1099.642,1098.24,1097.693,1095.909,1095.258,1094.744,1094.204,1093.141,1091.107,1090.527,1089.253,1088.841,1088.475,1087.402,1086.931,1086.278,1085.632,1084.882,1084.087,1083.213,1082.576,1082.197,1081.575,1080.827,1080.153,1079.467,1079.009,1078.646,1078.312,1077.627,1077.059,1076.684,1076.234,1076.127,1075.882,1075.528,1075.15,1075.801,1075.641,1075.572,1075.519,1076.323,1076.208,1076.307,1077.425,1077.329,1077.395,1078.379,1078.466,1078.702,1079.812,1080.093,1081.003,1081.298,1082.459,1082.848,1083.861,1084.12,1085.142,1085.627,1086.58,1087.004,1088.228,1088.697,1089.287,1090.325,1090.858,1091.529,1092.06,1092.996,1093.488,1094.13,1094.811,1095.258,1095.807,1096.378,1096.621,1097.231,1097.606,1098.195,1098.588,1098.81,1099.205,1099.634,1099.901,1100.18,1100.559,1100.734,1101.108,1101.422,1101.451,1101.674,1101.711,1102.045,1102.138,1102.094,1102.009,1101.35,1101.649,1101.666,1101.57,1101.135,1101.402,1101.52,1101.673,1101.821,1101.774,1101.887,1102.13,1101.861,1101.912,1101.56,1101.629,1101.103,1101.104,1100.317,1100.429,1100.136,1099.736,1098.752,1098.501,1097.958,1097.324,1096.394,1095.603,1094.751,1093.405,1090.991,1090.381,1089.437,1088.452,1087.168,1085.905,1084.045,1083.26,1082.297,1081.317,1080.493,1079.438,1078.587,1077.091,1076.338,1075.748,1075.021,1074.432,1073.379,1072.776,1071.914,1071.46,1071.292,1070.291,1069.625,1069.042,1068.299,1067.965,1067.495,1067.068,1067.058,1066.826,1066.365,1066.789,1066.513,1066.413,1066.406,1067.592,1067.529,1067.863,1068.001,1069.162,1069.261,1069.779,1070.217,1070.587,1071.812,1071.937,1072.95,1073.272,1073.662,1074.823,1075.581,1076.965,1077.647,1078.165,1079.788,1080.136,1080.67,1082.176,1082.676,1083.275,1083.92,1084.513,1085.336,1086.045,1086.491,1087.109,1087.693,1088.415,1089.082,1089.242,1089.8,1090.058,1090.31,1090.614,1091.073,1091.378,1091.742,1091.873,1092.083,1092.547,1092.871,1093.037,1093.632,1094.181,1094.52,1095.149,1095.536,1096.24,1096.015,1096.529,1097.025,1097.543,1097.789,1097.499,1098.008,1098.463,1098.866,1099.092,1099.208,1099.158,1099.408,1099.299,1099.521,1099.939,1100.132,1100.22,1100.296,1100.545,1100.568,1100.636,1100.115,1100.062,1099.354,1099.194,1098.802,1097.268,1096.921,1095.565,1095.013,1094.306,1092.949,1092.028,1090.498,1089.521,1088.936,1088.154,1086.85,1086.25,1084.892,1084.423,1084.119,1083.65,1082.045,1081.821,1081.812,1081.576,1081.233,1080.172,1079.9,1079.188,1078.824,1078.347,1077.397,1076.81,1076.253,1075.481,1074.369,1074.464,1073.425,1073.44,1073.396,1072.689,1072.231,1071.381,1070.721,1070.412,1069.949,1069.906,1069.379,1069.595,1069.096,1068.67,1068.493,1068.576,1069.453,1069.239,1069.222,1070.2,1070.185,1070.05,1071.23,1071.298,1071.578,1071.944,1073.323,1073.527,1074.625,1074.874,1075.968,1076.312,1077.543,1077.966,1079.147,1079.666,1080.846,1081.48,1082.274,1083.613,1084.248,1084.965,1086.134,1086.755,1087.487,1088.013,1088.53,1089.299,1089.778,1090.239,1090.821,1091.202,1091.617,1091.999,1092.447,1092.889,1093.208,1093.479,1094.008,1094.252,1094.735,1095.006,1095.585,1095.577,1096.095,1096.356,1096.66,1096.523,1096.945,1096.679,1097.158,1097.484,1097.413,1097.421,1097.085,1097.49,1097.865,1097.851,1098.304,1098.717,1099.023,1099.107,1099.412,1099.486,1099.279,1099.418,1099.086,1099.138,1098.752,1098.698,1098.513,1097.784,1097.294,1097.054,1096.451,1095.943,1094.802,1094.261,1093.489,1091.614,1090.977,1090.112,1089.039,1087.202,1086.368,1084.823,1083.881,1082.201,1081.236,1080.322,1079.325,1076.77,1076.248,1075.2,1074.804,1073.523,1072.413,1071.972,1071.085,1070.667,1069.528,1068.69,1067.728,1067.377,1066.806,1066.425,1065.944,1065.294,1065.017,1064.448,1063.997,1063.895,1063.215,1062.815,1062.685,1062.605,1062.507,1063.257,1063.059,1063.178,1063.33,1063.282,1063.539,1063.754,1065.066,1065.229,1065.593,1066.025,1067.447,1067.829,1068.345,1069.584,1069.962,1071.514,1072.34,1073.753,1074.305,1075.783,1076.373,1077.645,1078.223,1079.03,1080.73,1081.391,1081.885,1082.584,1083.165,1083.882,1084.511,1085.083,1085.594,1086.143,1086.61,1086.958,1087.382,1088.015,1088.45,1088.852,1089.281,1089.312,1089.797,1090.25,1090.724,1091.297,1091.745,1092.188,1092.726,1093.263,1093.61,1094.363,1094.509,1094.976,1095.216,1095.281,1095.714,1096.06,1095.99,1096.257,1096.119,1096.434,1096.94,1097.425,1097.829,1098.107,1098.326,1098.63,1098.834,1099.073,1099.222,1099.534,1099.699,1099.83,1099.792,1099.577,1099.433,1099.14,1098.541,1098.035,1096.395,1095.92,1094.561,1093.806,1092.852,1091.598,1089.296,1088.522,1087.665,1086.069,1085.367,1083.632,1083.04,1081.567,1081.166,1080.691,1079.145,1078.581,1078.627,1078.369,1077.724,1077.01,1076.428,1075.613,1075.073,1074.415,1073.871,1072.85,1072.01,1071.371,1071.05,1070.111,1069.389,1068.467,1067.704,1066.956,1065.833,1065.223,1064.512,1064.106,1063.339,1062.134,1061.747,1061.578,1062.212,1061.591,1061.068,1060.694,1060.276,1061.43,1060.922,1060.77,1062.018,1061.732,1061.667,1061.783,1062.876,1062.798,1062.996,1064.09,1064.043,1064.267,1065.344,1065.54,1066.292,1066.694,1067.825,1068.244,1069.925,1070.367,1070.994,1072.257,1072.748,1073.696,1074.153,1074.723,1075.587,1076.118,1076.508,1077.129,1077.731,1078.154,1078.6,1079.001,1079.553,1080.06,1080.415,1080.74,1081.084,1081.394,1081.679,1081.774,1081.819,1081.715,1082.122,1082.439,1082.536,1082.829,1083.121,1083.14,1083.317,1083.607,1083.756,
	1083.373,1083.739,1083.983,1084.261,1083.983,1084.224,1084.326,1084.578,1084.583,1084.463,1084.796,1085.028,1085.156,1085.122,1084.992,1084.821,1084.743,1084.091,1083.835,1083.374,1081.973,1081.783,1081.412,1080.442,1079.898,1079.312,1078.131,1077.345,1075.932,1075.079,1073.723,1072.851,1071.428,1070.552,1069.215,1067.325,1066.426,1065.262,1063.334,1062.522,1061.367,1060.28,1057.885,1057.038,1056.079,1054.963,1053.595,1052.839,1052,1050.788,1049.896,1048.864,1047.77,1047.405,1045.965,1044.822,1044.279,1043.867,1043.171,1042.536,1041.861,1041.139,1040.55,1040.145,1039.93,1039.784,1039.6,1039.338,1040.161,1039.996,1039.918,1039.911,1039.878,1039.845,1041.857,1041.726,1042.937,1043.055,1044.309,1044.756,1046.188,1046.546,1046.943,1048.017,1048.824,1050.285,1050.805,1052.809,1053.854,1055.105,1055.88,1057.47,1058.226,1059.592,1060.326,1061.56,1062.269,1063.322,1064.112,1064.713,1065.682,1066.268,1066.787,1067.03,1067.461,1067.982,1068.681,1069.57,1070.342,1070.689,1071.39,1072.334,1073.1,1073.805,1073.766,1072.93,1073.203,1073.751,1074.433,1074.9,1075.035,1075.302,1075.44,1076.08,1076.395,1076.918,1077.238,1076.8,1077.24,1077.602,1077.91,1078.144,1078.204,1078.169,1078.01,1078.23,1078.57,1078.85,1078.954,1079.381,1079.542,1079.394,1079.562,1079.64,1079.409,1079.264,1078.983,1078.626,1078.417,1077.146,1076.42,1075.907,1074.44,1073.798,1071.883,1071.098,1069.174,1067.511,1066.785,1065.434,1064.455,1062.947,1061.638,1060.901,1059.793,1059.02,1056.897,1056.802,1056.999,1057.718,1057.387,1056.147,1055.949,1053.68,1053.829,1053.129,1052.847,1052.135,1050.573,1050.138,1049.244,1048.548,1048.626,1048.202,1047.757,1047.657,1047.188,1046.865,1049.012,1048.942,1048.943,1049.063,1048.898,1048.872,1049.735,1049.702,1049.734,1051.38,1051.355,1051.366,1051.529,1051.911,1053.237,1051.361,1051.492,1051.694,1052.071,1053.243,1053.633,1055.352,1056.048,1056.52,1057.691,1058.34,1059.745,1060.32,1061.631,1062.181,1063.455,1064.129,1064.908,1066.247,1066.879,1067.636,1068.536,1069.118,1069.928,1070.623,1071.382,1071.937,1072.536,1073.096,1073.73,1074.169,1074.566,1075.052,1075.252,1075.837,1076.27,1076.626,1077.214,1077.596,1077.856,1078.011,1078.436,1078.785,1079.287,1079.621,1079.828,1080.115,1080.365,1080.456,1079.985,1080.258,1080.451,1080.614,1080.613,1079.882,1080.184,1080.385,1080.57,1080.629,1080.748,1080.971,1081.193,1081.447,1081.746,1081.913,1081.985,1082.008,1081.968,1081.822,1081.714,1081.473,1080.877,1080.912,1080.371,1080.031,1079.401,1078.565,1077.554,1076.527,1074.659,1073.852,1072.845,1071.755,1069.485,1068.77,1068.031,1066.81,1065.665,1063.85,1062.982,1062.245,1060.435,1059.747,1058.773,1058.179,1057.94,1056.414,1055.093,1054.489,1053.627,1052.733,1052.536,1051.666,1051.081,1050.595,1050.084,1049.291,1048.986,1048.966,1048.711,1048.191,1047.778,1047.81,1047.48,1047.265,1047.18,1047.158,1048.165,1047.959,1047.974,1048.727,1048.685,1049.245,1049.042,1050.077,1050.101,1050.797,1050.958,1051.787,1052.156,1053.128,1053.372,1054.099,1054.553,1055.081,1055.671,1056.881,1057.345,1057.835,1058.462,1058.919,1059.714,1060.102,1060.934,1061.347,1061.855,1062.366,1063.148,1063.648,1063.896,1064.43,1064.661,1065.253,1065.646,1065.753,1066.03,1066.444,1066.635,1066.829,1067.368,1067.588,1067.835,1068.04,1068.328,1068.6,1068.939,1069.058,1069.529,1069.485,1069.945,1069.887,1070.12,1069.935,1070.189,1070.369,1070.496,1070.644,1070.763,1070.862,1070.906,1070.695,1070.577,1070.446,1070.232,1070.23,1070.015,1070.032,1069.997,1069.455,1069.49,1069.369,1068.813,1068.521,1068.208,1066.954,1066.63,1065.175,1064.731,1063.35,1062.524,1061.661,1059.744,1058.896,1057.157,1056.468,1055.579,1053.728,1052.9,1051.54,1050.865,1049.384,1048.823,1048.452,1047.186,1046.676,1045.42,1045.233,1044.99,1044.795,1044.166,1043.48,1042.958,1042.363,1041.622,1041.066,1040.117,1039.702,1039.084,1038.471,1038.122,1037.401,1037.104,1036.253,1036.462,1035.871,1035.347,1034.947,1033.2,1033.242,1033.166,1034.398,1034.242,1034.057,1034.588,1034.517,1034.528,1034.784,1036.202,1036.316,1036.656,1037.141,1038.625,1038.914,1039.434,1040.827,1041.253,1042.745,1043.274,1044.021,1045.648,1046.244,1047.574,1048.189,1049.54,1050.167,1051.563,1052.271,1053.099,1054.473,1055.098,1056.09,1056.659,1057.393,1057.999,1058.477,1059.058,1059.628,1060.212,1060.777,1061.148,1061.82,1061.851,1062.535,1062.948,1063.54,1063.88,1064.527,1064.966,1065.546,1066.085,1066.742,1067.177,1067.714,1068.182,1068.595,1069.079,1069.662,1070.138,1070.171,1070.638,1071.101,1071.418,1071.777,1071.314,1071.692,1072.048,1072.124,1072.697,1073.255,1073.722,1073.931,1074.01,1074.225,1074.822,1074.583,1074.937,1074.834,1075.109,1075.156,1074.555,1074.709,1074.236,1074.369,1074.212,1073.723,1072.695,1072.665,1072.386,1071.011,1070.755,1070.282,1069.743,1069.1,1068.231,1065.961,1065.74,1065.135,1064.61,1063.973,1062.643,1062.491,1061.958,1061.514,1060.231,1059.781,1059.506,1059.149,1058.706,1057.696,1057.406,1056.784,1056.714,1056.331,1056.107,1055.948,1055.857,1055.701,1055.595,1055.616,1055.502,1055.5,1055.498,1056.124,1055.847,1056.177,1057.143,1057.212,1057.245,1057.353,1059.333,1059.435,1061.807,1061.744,1061.832,1062.871,1063.213,1064.259,1064.715,1065.948,1066.783,1067.96,1068.318,1069.468,1070.095,1070.965,1072.8,1073.399,1074.259,1075.232,1076.018,1077.24,1078.368,1079.254,1080.22,1080.772,1081.424,1082.128,1082.813,1083.445,1084.266,1084.809,1085.478,1085.979,1086.914,1087.476,1088.09,1089.024,1089.807,1090.516,1091.174,1091.838,1092.449,1093.176,1093.745,1094.308,1095.139,1095.8,1096.364,1095.839,1096.55,1097.263,1098.055,1098.674,1099.273,1099.902,1100.457,1101.119,1101.629,1101.918,1102.066,1102.512,1103.108,1103.65,1103.951,1104.297,1104.471,1104.957,1105.358,1105.94,1104.793,1105.125,1104.237,1104.444,1103.421,1102.392,1100.358,1100.322,1099.75,1098.253,1098.019,1096.652,1096.291,1095.846,1095.278,1094.008,1093.901,1093.364,1092.721,1091.681,1091.211,1091.017,1090.606,1089.919,1089.555,1089.412,1089.161,1088.729,1088.375,1087.978,1087.422,1086.36,1085.737,1085.945,1086.271,1085.963,1085.665,1085.412,1085.035,1084.468,1083.687,1083.18,1082.304,1082.043,1081.747,1081.246,1080.763,1083.322,1083.21,1083.225,1083.641,1083.434,1083.385,1083.576,1083.772,1084.825,1084.858,1085.122,1085.707,1086.253,1086.841,1087.457,1090.603,1091.352,1091.97,1093.676,1091.591,1092.335,1094.258,1094.926,1096.359,1097.075,1098.61,1099.384,1100.966,1101.798,1103.43,1104.268,1105.635,1106.503,1107.394,1108.755,1109.595,1110.458,1111.436,1112.224,1112.933,1113.571,1114.418,1114.938,1115.695,1116.328,1116.963,1117.58,1118.266,1118.889,1119.581,1120.131,1120.88,1121.66,1122.521,1123.012,1123.85,1123.895,1124.852,1125.646,1125.743,1126.318,1126.056,1126.774,1127.368,1127.354,0]
;

const flat = [4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5];

test('PeakFinder - Hips distance', (t) => {
	const config = {
		distance: 100, 
	};

	const peaks = PeakFinder.findPeaks(Float32Array.from(hipsX), config);
	const peakPositions = peaks.map(p => p.mid);

	t.deepEqual(peakPositions, [
		115,  238,  365,  493,  620,
		747,  872,  999, 1123, 1252,
		1374, 1506, 1623, 1742, 1886,
		2008, 2136, 2258, 2389, 2515,
		2628, 2767, 2887, 2998
	]);
});

test('PeakFinder - Hips distance prominence', (t) => {
	const config = {
		distance: 100, 
		prominence: 30, 
	};

	const peaks = PeakFinder.findPeaks(Float32Array.from(hipsX), config);
	const peakPositions = peaks.map(p => p.mid);

	t.deepEqual(peakPositions, [
		115,  493,  620,  747,
		1123, 1374, 1506, 1886,
		2008, 2136, 2389, 2515,
		2998
	]);
});

test('PeakFinder - Hips distance prominence window', (t) => {
	const config = {
		distance: 100, 
		prominence: 30, 
		window: 120, 
	};

	const peaks = PeakFinder.findPeaks(Float32Array.from(hipsX), config);
	const peakPositions = peaks.map(p => p.mid);

	t.deepEqual(peakPositions, [1374, 2136, 2389, 2998]);
});

test('PeakFinder - Hips width', (t) => {
	const config = {
		width: 75, 
	};

	const peaks = PeakFinder.findPeaks(Float32Array.from(hipsX), config);
	const peakPositions = peaks.map(p => p.mid);

	t.deepEqual(peakPositions, [747, 1374, 2515, 2998]);
});

test('PeakFinder - Hips width window', (t) => {
	const config = {
		width: 75, 
		window: 400, 
	};

	const peaks = PeakFinder.findPeaks(Float32Array.from(hipsX), config);
	const peakPositions = peaks.map(p => p.mid);

	t.deepEqual(peakPositions, [747, 1374, 2515]);
});

test('PeakFinder - Hips width prominence', (t) => {
	const config = {
		width: 75, 
		prominence: 65, 
	};

	const peaks = PeakFinder.findPeaks(Float32Array.from(hipsX), config);
	const peakPositions = peaks.map(p => p.mid);

	t.deepEqual(peakPositions, [1374, 2998]);
});

test('PeakFinder - Hips prominence', (t) => {
	const config = {
		prominence: 50, 
	};

	const peaks = PeakFinder.findPeaks(Float32Array.from(hipsX), config);
	const peakPositions = peaks.map(p => p.mid);

	t.deepEqual(peakPositions, [747, 1374, 2998]);
});

test('PeakFinder - Hips height', (t) => {
	const config = {
		height: 1120, 
	};
	
	const peaks = PeakFinder.findPeaks(Float32Array.from(hipsX), config);
	const peakPositions = peaks.map(p => p.mid);

	t.deepEqual(peakPositions, [
		1374, 1376,
		1483, 1486,
		1506, 2995,
		2998
	]);
});

test('PeakFinder - Hips height distance', (t) => {
	const config = {
		height: 1120, 
		distance: 100,
	};
	
	const peaks = PeakFinder.findPeaks(Float32Array.from(hipsX), config);
	const peakPositions = peaks.map(p => p.mid);

	t.deepEqual(peakPositions, [1374, 1506, 2998]);
});

test('PeakFinder - min/max', (t) => {
	const config = {
		height: {
			min: 1050,
			max: 1100,
		}, 
		width: {
			min: 60,
			max: 70,
		},
		prominence: {
			min: 10,
			max: 50,
		},
	};
	
	const peaks = PeakFinder.findPeaks(Float32Array.from(hipsX), config);
	const peakPositions = peaks.map(p => p.mid);

	t.deepEqual(peakPositions, [
		238,  365, 1123,
		2008, 2136, 2258,
		2389, 2628
	]);
});


test('PeakFinder - Flat signal', (t) => {
	const config = {
		height: 1120, 
		distance: 100,
	};

	const peaks = PeakFinder.findPeaks(Float32Array.from(flat), config);
	const peakPositions = peaks.map(p => p.mid);

	t.deepEqual(peakPositions, []);
}); 

test('PeakFinder - sequence simple', (t) => {
	const config = {
		height: {
			min: 1050,
			max: 1100,
		}, 
		width: {
			min: 60,
			max: 70,
		},
		prominence: {
			min: 10,
			max: 50,
		},
		sequence: {
			ranges: 'L 50 H',
			pattern: 'HHL',
			keep: [0],
		}
	};
	
	const peaks = PeakFinder.findPeaks(Float32Array.from(hipsX), config);
	const peakPositions = peaks.map(p => p.mid);

	t.deepEqual(peakPositions, [238, 2008]);
});

test('PeakFinder - sequence advanced', (t) => {
	const config = {
		distance: 100,
		sequence: {
			ranges: 'L 33 M 66 H',
			pattern: 'LMH',
			keep: [0, 2],
		}
	};
	
	const peaks = PeakFinder.findPeaks(Float32Array.from(hipsX), config);
	const peakPositions = peaks.map(p => p.mid);

	t.deepEqual(peakPositions, [1123, 1374, 2767, 2998]);
});

test('PeakFinder - sequence extension - leading success', (t) => {
	const config = {
		distance: 100,
		sequence: {
			ranges: 'L 33 M 66 H',
			pattern: 'LLM',
			keep: [0],
		}
	};
	
	const peaks = PeakFinder.findPeaks(Float32Array.from(hipsX), config);
	const peakPositions = peaks.map(p => p.mid);

	t.deepEqual(peakPositions, [238, 999, 2628]);
});

test('PeakFinder - sequence extension - trailing success', (t) => {
	const config = {
		height: {
			min: 1050,
			max: 1100,
		}, 
		width: {
			min: 60,
			max: 70,
		},
		prominence: {
			min: 10,
			max: 50,
		},
		sequence: {
			pattern: 'LHHLL',
			keep: [0],
		}
	};
	
	const peaks = PeakFinder.findPeaks(Float32Array.from(hipsX), config);
	const peakPositions = peaks.map(p => p.mid);

	t.deepEqual(peakPositions, [1123, 2628]);
});

test('PeakFinder - missing keep', (t) => {
	const config = {
		height: {
			min: 1050,
			max: 1100,
		}, 
		width: {
			min: 60,
			max: 70,
		},
		prominence: {
			min: 10,
			max: 50,
		},
		sequence: {
			pattern: 'LHHLL',
		}
	};
	
	const peaks = PeakFinder.findPeaks(Float32Array.from(hipsX), config);
	const peakPositions = peaks.map(p => p.mid);

	t.deepEqual(peakPositions, [
		238,  365, 1123,
		2008, 2136, 2258,
		2389, 2628
	]);
});


test('PeakFinder - Invalid relHHeight', (t) => {
	const config = {
		width: 60,
		relHeight: -1,
	};

	t.throws(() => {
		PeakFinder.findPeaks(Float32Array.from(hipsX), config);
	}, { message: '\'relHeight\' must be greater or equal to 0.0'});
}); 


test('PeakFinder - Invalid distance', (t) => {
	const config = {
		distance: 0,
	};

	t.throws(() => {
		PeakFinder.findPeaks(Float32Array.from(hipsX), config);
	}, { message: '\'distance\' must be greater or equal to 1.'});
}); 
